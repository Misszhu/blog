# 正则表达式——匹配位置

正则表达式要么匹配字符，要么匹配位置。  

## 位置

位置的是相邻的两个字符中间的**地方**叫**位置**。位置是个有点抽象事物。把位置和“**指缝**”类比可能好理解一些。我们有5个手指，相邻的两个手指中间的地方叫指缝。实际上相邻两个手指中间是没有任何东西的，但指缝又是真实存在的。结合图片体会一下：

位置就是**标记**的意思：比如正则表达式`/^ab$/`，`^` 做了一个标记，告诉JS解析引擎我这里是开头，接下来有`ab`两个字符，最后到`$`说我这里标记结束了。

```javascript
var regex = /^ab$/g;
var str1 = 'ab';
var str2 = 'ab abc';
console.log(str1.match(regex)); // ["ab"]
console.log(str2.match(regex)); // null
```

从上面的示例代码可以看出，`^` 和`$`分别标记了开头和结束的位置`/^ab$/g`只能匹配字符串`ab`。

## 匹配位置

正则表达式中有6个锚表示位置：`^, $, \b, \B, ?=p, ?!p`。

### ^ 和 $

`^  `匹配开头的位置，在多行模式中匹配行开头的位置。

`$` 匹配结尾的位置，在多行模式中匹配行结尾的位置。

```javascript
var regex = /^|$/gm;
'I\nlove\njavascript'.replace(regex, '#')
/*
#I#
#love#
#javascript#
*/
```

> m表示多行模式

### \b 和 \B

`\b` 是 boundary的简写，翻译过来就是字符边界。什么意思呢？第一章提到的，`\w`是 word即字符的简写。`\w`匹配数字、字母以及下划线。因此，字符边界匹配`\w`（字符）和 `\W`（非字符）中间的位置。比如在字符串 `#2` 中 ，`#` 和 `2` 中间的位置就是字符边界。字符边界还包括 `^`和`\w`、`\w `和 `$` 中间的位置。

```javascript
var result = "[JS] Lesson_01.mp4".replace(/\b/g, '#'); 
console.log(result);
// [#JS#] #Lesson_01#.#mp4#
```

`\B`和 `\b`相反，`\B` 是nonBoundary的缩写，即非字符边界。类似的，非字符边界包括`^`和`\W`、`\W` 和 `$`、`\W`和`\W `、`\W` 和 `$`中间的位置。

```javascript
var result = "[JS] Lesson_01.mp4".replace(/\B/g, '#'); 
console.log(result);
//#[J#S]# L#e#s#s#o#n#_#0#1.m#p#4
```

### ?=p 和 ?!p

`?=p` 匹配 `p`前面的位置，我把`p` 理解成 pattern（模式）。pattern也是匹配字符或者匹配位置，说成**子正则**更容易理解。

```javascript
var result = 'hello'.replace(/(?=l)/g, '#');
console.log(result);
// he#l#lo
```

上面的示例代码中， `(?=l)`匹配字母 `l`前面的位置，因为有两个`l`，所以在这两个位置插入`#`。

`!是 **非** 的意思,和 `?=p` 相反，`?!p` 匹配不是 `p` 前面的位置。

```javascript
var result = 'hello'.replace(/(?!l)/g, '#');
console.log(result);
// #h#ell#o#
```

除了两个字母`l`前面的位置，其他都不是`l`前面的位置，所以在除了这两个位置的所有位置前面都插入了`#`。

`?=p` 也可以理解为：**接下来的字符与 p 匹配**。

`?!p` 也可以理解为：**接下来的字符不与 p 匹配**。


